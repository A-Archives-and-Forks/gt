"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),r=require("react"),a=require("generaltranslation");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("xxhashjs");var t=n(r),i=function(){return i=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++)for(var t in r=arguments[a])Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e},i.apply(this,arguments)};function o(e,r){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(n=Object.getOwnPropertySymbols(e);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(a[n[t]]=e[n[t]])}return a}function l(e,r,a,n){return new(a||(a=Promise))((function(t,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function l(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var r;e.done?t(e.value):(r=e.value,r instanceof a?r:new a((function(e){e(r)}))).then(o,l)}u((n=n.apply(e,r||[])).next())}))}function u(e,r){var a,n,t,i={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(u){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(t=2&l[0]?n.return:l[0]?n.throw||((t=n.return)&&t.call(n),0):n.next)&&!(t=t.call(n,l[1])).done)return t;switch(n=0,t&&(l=[2&l[0],t.value]),l[0]){case 0:case 1:t=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(t=i.trys,(t=t.length>0&&t[t.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!t||l[1]>t[0]&&l[1]<t[3])){i.label=l[1];break}if(6===l[0]&&i.label<t[1]){i.label=t[1],t=l;break}if(t&&i.label<t[2]){i.label=t[2],i.ops.push(l);break}t[2]&&i.ops.pop(),i.trys.pop();continue}l=r.call(e,i)}catch(e){l=[6,e],n=0}finally{a=t=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}}"function"==typeof SuppressedError&&SuppressedError;var s=r.createContext(void 0);function c(e){void 0===e&&(e="useGTContext() must be used within a <GTProvider>!");var a=r.useContext(s);if(void 0===a)throw new Error(e);return a}function d(){return c("useDefaultLocale(): Unable to access default locale outside of a <GTProvider>").defaultLocale}function v(){return c("useLocale(): Unable to access user's locale outside of a <GTProvider>").locale}function p(e){return e&&e.props&&e.props["data-generaltranslation"]?e.props["data-generaltranslation"]:null}var f={variable:"value",number:"n",datetime:"date",currency:"cost"};function b(e){var r,a=(null===(r=e["data-generaltranslation"])||void 0===r?void 0:r.variableType)||"variable";return{variableType:a,variableName:e.name||e["data-gt-variable-name"]||f[a],variableValue:void 0!==e.value?e.value:void 0!==e["data-gt-unformatted-value"]?e["data-gt-unformatted-value"]:void 0!==e.children?e.children:void 0,variableOptions:e.options||e["data-gt-variable-options"]||void 0}}function h(r){var n=void 0===r?{name:"n"}:r,t=n.children,i=n.name,o=void 0===i?"n":i,l=n.value,u=n.options,s=void 0===u?{}:u,c=[v(),d()],p=void 0!==t?t:l;return"number"==typeof(p="string"==typeof p?parseFloat(p):p)&&(p=a.formatNum({value:p,languages:c,options:s})),e.jsx("span",{"data-gt-variable-name":o,"data-gt-variable-type":"number","data-gt-variable-options":JSON.stringify(s),children:p})}function g(r){var a=r.children,n=r.name,t=r.value,i=void 0!==a?a:t;return e.jsx("span",{"data-gt-variable-name":n,"data-gt-variable-type":"variable",children:i})}function m(r){var n=void 0===r?{name:"cost"}:r,t=n.children,o=n.name,l=void 0===o?"cost":o,u=n.value,s=n.currency,c=void 0===s?"USD":s,p=n.options,f=void 0===p?{}:p,b=[v(),d()],h=void 0!==t&&void 0===u?t:u;return"number"==typeof(h="string"==typeof h?parseFloat(h):h)&&(h=a.formatCurrency({value:h,languages:b,currency:c,options:f})),e.jsx("span",{"data-gt-variable-name":l,"data-gt-variable-type":"currency","data-gt-variable-options":i({style:"currency",currency:c},f),children:h})}function y(r){var n,t,i=void 0===r?{name:"date"}:r,o=i.children,l=i.name,u=void 0===l?"date":l,s=i.value,c=i.options,p=void 0===c?{}:c,f=[v(),d()],b=void 0!==o&&void 0===s?o:s;return"number"==typeof b||"string"==typeof b?t=new Date(b):b instanceof Date&&(t=b),void 0!==t&&(n=a.formatDateTime({value:t,languages:f,options:p}).replace(/[\u200F\u202B\u202E]/g,"")),e.jsx("span",{"data-gt-variable-name":u,"data-gt-variable-type":"date","data-gt-variable-options":p,children:n})}function w(e){if(e&&"object"==typeof e&&"string"==typeof e.key){var r=Object.keys(e);if(1===r.length)return!0;if(2===r.length){var a=e;return"string"==typeof a.variable&&["variable","number","date","currency"].includes(a.variable)}}return!1}h.gtTransformation="variable-number",g.gtTransformation="variable-variable",m.gtTransformation="variable-currency",y.gtTransformation="variable-datetime";var O="generaltranslation-locale",x="en",j=["singular","plural","dual","zero","one","two","few","many","other"];var T={};function E(e,a,n){void 0===n&&(n=0);var l=n,u=function(e){var r=e.type,a=e.props,n={id:l+=1},t="function"==typeof r&&r.gtTransformation||"";if(t){var i=t.split("-");if("variable"===i[0]&&(n.variableType=(null==i?void 0:i[1])||"variable"),"plural"===i[0]){var u=Object.entries(a).reduce((function(e,r){var a,n=r[0],t=r[1];return a=n,j.includes(a)&&(e[n]=E(t,n,l)),e}),{});Object.keys(u).length&&(n.branches=u)}if("branch"===i[0]){a.children,a.branch;var s=o(a,["children","branch"]),c=Object.entries(s).reduce((function(e,r){var a=r[0],n=r[1];return e[a]=E(n,a,l),e}),{});Object.keys(c).length&&(n.branches=c)}n.transformation=i[0]}return n};function s(e){if(r.isValidElement(e)){var n=e.props,o=u(e),l=i(i({},n),{"data-generaltranslation":o});return a&&(l.key=a,a=void 0),n.children&&(l.children=c(n.children)),t.default.cloneElement(e,l)}return e}function c(e){return Array.isArray(e)?(a=void 0,t.default.Children.map(e,s)):s(e)}return c(e)}function k(e,r,a){var n="",t=null;return"number"==typeof e&&!t&&a&&(n=function(e,r,a){var n=new Intl.PluralRules(r).select(e),t=Math.abs(e);if(0===t&&a.zero)return"zero";if(1===t){if(a.singular)return"singular";if(a.one)return"one"}if("one"===n&&a.singular)return"singular";if(2===t){if(a.dual)return"dual";if(a.two)return"two"}return"two"===n&&a.dual?"dual":a[n]?n:"two"===n&&a.dual?"dual":"two"===n&&a.plural?"plural":"two"===n&&a.other?"other":"few"===n&&a.plural?"plural":"few"===n&&a.other?"other":"many"===n&&a.plural?"plural":"many"===n&&a.other?"other":"other"===n&&a.plural?"plural":""}(e,r,a)),n&&!t&&(t=a[n]),t}function P(r){var a=r.variableType,n=r.variableName,t=r.variableValue,i=r.variableOptions;return"number"===a?e.jsx(h,{name:n,value:t,options:i}):"datetime"===a?e.jsx(y,{name:n,value:t,options:i}):"currency"===a?e.jsx(m,{name:n,value:t,options:i}):e.jsx(g,{name:n,value:t})}function L(e){var r,a=e.sourceElement,n=e.targetElement,o=e.variables,l=void 0===o?{}:o,u=e.variablesOptions,s=void 0===u?{}:u,c=e.locales,d=void 0===c?[x]:c,v=a.props,p=v["data-generaltranslation"],f=null==p?void 0:p.transformation;if("plural"===f){var b="number"==typeof l.n?l.n:"number"==typeof a.props.n?a.props.n:a.props["data-gt-n"],h=k(b,d,p.branches||{})||a.props.children,g=k(b,d,n.props["data-generaltranslation"].branches||{})||n.props.children;return t.default.createElement("span",i(i({},v),{"data-generaltranslation":void 0,children:A({source:h,target:g,variables:l,variablesOptions:s,locales:d})}))}if("branch"===f){var m=v.name,y=v.branch,w=v.children;y=l[m=m||a.props["data-gt-name"]||"branch"]||y||a.props["data-gt-branch-name"];h=(p.branches||{})[y]||w,g=(n.props["data-generaltranslation"].branches||{})[y]||n.props.children;return t.default.createElement("span",i(i({},v),{"data-generaltranslation":void 0,children:A({source:h,target:g,variables:l,variablesOptions:s,locales:d})}))}return(null==v?void 0:v.children)&&(null===(r=n.props)||void 0===r?void 0:r.children)?t.default.cloneElement(a,i(i({},v),{"data-generaltranslation":void 0,children:A({source:v.children,target:n.props.children,variables:l,variablesOptions:s,locales:d})})):a}function A(r){var a=r.source,n=r.target,o=r.variables,l=void 0===o?{}:o,u=r.variablesOptions,s=void 0===u?{}:u,c=r.locales,d=void 0===c?[x]:c;if(null==n&&a)return a;if("string"==typeof n)return n;if(Array.isArray(a)&&Array.isArray(n)){var v=a.filter((function(e){if(t.default.isValidElement(e)){var r=p(e);if(b(e.props),"variable"!==(null==r?void 0:r.transformation))return!0;var a=b(e.props),n=a.variableName,o=a.variableValue,u=a.variableOptions;void 0===l[n]&&(l[n]=o),s[n]=i(i({},s[n]),u)}}));return n.map((function(r,a){if("string"==typeof r)return e.jsx(t.default.Fragment,{children:r},"string_".concat(a));if(w(r))return e.jsx(t.default.Fragment,{children:P({variableType:r.variable||"variable",variableName:r.key,variableValue:l[r.key],variableOptions:s[r.key]})},"var_".concat(a));var n,i=(n=r,v.find((function(e){var r,a,t=p(e);return void 0!==(null==t?void 0:t.id)&&t.id===(null===(a=null===(r=null==n?void 0:n.props)||void 0===r?void 0:r["data-generaltranslation"])||void 0===a?void 0:a.id)})));return i?e.jsx(t.default.Fragment,{children:L({sourceElement:i,targetElement:r,variables:l,variablesOptions:s,locales:d})},"element_".concat(a)):void 0}))}if(n&&"object"==typeof n&&!Array.isArray(n)){var f=w(n)?"variable":"element";if(t.default.isValidElement(a)){if("element"===f)return L({sourceElement:a,targetElement:n,variables:l,variablesOptions:s,locales:d});var h=p(a);if("variable"===(null==h?void 0:h.transformation)){var g=b(a.props),m=g.variableName,y=g.variableValue,O=g.variableOptions;void 0===l[m]&&(l[m]=y),s[m]=i(i({},s[m]),O)}}if("variable"===f){var j=n;return P({variableType:j.variable||"variable",variableName:j.key,variableValue:l[j.key],variableOptions:s[j.key]})}}}function S(e){var r=e.children,a=e.variables,n=void 0===a?{}:a,l=e.variablesOptions,u=void 0===l?{}:l,s=e.defaultLocale,c=void 0===s?x:s,d=function(e){if(t.default.isValidElement(e)){var r=p(e);if("variable"===(null==r?void 0:r.transformation)){var a=b(e.props),l=a.variableName,s=a.variableType,d=a.variableValue,f=a.variableOptions;return P({variableName:l,variableType:s,variableValue:d=void 0!==n[l]?n[l]:d,variableOptions:i(i({},u[l]),f)})}if("plural"===(null==r?void 0:r.transformation)){var h="number"==typeof n.n?n.n:"number"==typeof e.props.n?e.props.n:e.props["data-gt-n"],g=r.branches||{};return t.default.createElement("span",i(i({},e.props),{"data-generaltranslation":void 0,children:v(k(h,[c],g)||e.props.children)}))}if("branch"===(null==r?void 0:r.transformation)){var m=e.props;m.children;var y=m.name,w=m.branch;g=o(m,["children","name","branch"]);return y=y||e.props["data-gt-name"]||"branch",w=n[y]||w||e.props["data-gt-branch-name"],g=r.branches||{},t.default.createElement("span",i(i({},e.props),{"data-generaltranslation":void 0,children:v(g[w])}))}if(e.props.children)return t.default.cloneElement(e,i(i({},e.props),{"data-generaltranslation":void 0,children:v(e.props.children)}))}return e},v=function(e){return Array.isArray(e)?t.default.Children.map(e,d):d(e)};return v(r)}function V(e){void 0===e&&(e="");var r=function(r){return e?"".concat(e,".").concat(r):r},a=c("useGT('".concat(e,"'): No context provided. You're trying to get the t() function on the client, which can only be done inside a <GTProvider>.")).translate;return function(e,n,t){void 0===e&&(e=""),void 0===n&&(n={});var i=r(e),o=a?a(i,n,t):void 0;return o||console.warn("t('".concat(e,"') finding no translation for dictionary item ").concat(i," !")),o}}function C(e,a){void 0===e&&(e=x),void 0===a&&(a=O);var n=r.useState(""),t=n[0],i=n[1];return r.useEffect((function(){var r=(a?function(e){void 0===e&&(e=O);for(var r=0,a=document.cookie.split("; ");r<a.length;r++){var n=a[r].split("="),t=n[0],i=n[1];if(t===e)return decodeURIComponent(i)}return null}(a):void 0)||navigator.language||(null===navigator||void 0===navigator?void 0:navigator.userLanguage)||e;i(r)}),[e]),t}function N(r){var a=r.children,n=r.n,t=o(r,["children","n"]),i=t["data-generaltranslation"],l=o(t,["data-generaltranslation"]),u=v(),s=d();if("number"!=typeof n)throw new Error('Plural with children "'.concat(a,'" requires "n" option.'));var c=k(n,[u,s],l)||a;return e.jsx("span",{"data-generaltranslation":i,"data-gt-n":n,children:c})}function G(r){var a=r.children,n=r.name,t=void 0===n?"branch":n,i=r.branch,l=o(r,["children","name","branch"]),u=l["data-generaltranslation"],s=o(l,["data-generaltranslation"]),c=i&&void 0!==s[i]?s[i]:a;return e.jsx("span",{"data-generaltranslation":u,"data-gt-name":t||"branch","data-gt-branch-name":i,children:c})}N.gtTransformation="plural",G.gtTransformation="branch",exports.Branch=G,exports.Currency=m,exports.DateTime=y,exports.GTProvider=function(n){var i=this,o=n.children,c=n.projectID,d=n.dictionary,v=void 0===d?T:d,p=n.dictionaryName,f=void 0===p?"default":p,b=n.locales,h=n.defaultLocale,g=void 0===h?(null==b?void 0:b[0])||x:h,m=n.locale,y=n.cacheURL,w=void 0===y?"https://cache.gtx.dev":y;if(!c&&"https://cache.gtx.dev"===w)throw new Error("gt-react Error: General Translation cloud services require a project ID! Find yours at www.generaltranslation.com/dashboard.");var O=C(g);m=m||O,b&&(m=a.determineLanguage([m,O],b)||m);var j=!m||!a.isSameLanguage(m,g),k=r.useState(w?null:{}),P=k[0],L=k[1];r.useEffect((function(){P||(j?l(i,void 0,void 0,(function(){var e;return u(this,(function(r){switch(r.label){case 0:return[4,fetch("".concat(w,"/").concat(c,"/").concat(m,"/").concat(f))];case 1:return[4,r.sent().json()];case 2:return e=r.sent(),L(e),[2]}}))})):L({}))}),[P,j]);var V=r.useCallback((function(e,r,n){void 0===r&&(r={});var i=function(e){if(Array.isArray(e)){if(1===e.length)return{entry:e[0]};if(2===e.length)return{entry:e[0],metadata:e[1]}}return{entry:e}}(function(e,r){if(!r||"string"!=typeof r)throw new Error('Invalid dictionary id: "'.concat(r,'"'));for(var a=e,n=0,i=r.split(".");n<i.length;n++){var o=i[n];if("object"!=typeof a||Array.isArray(a)||t.default.isValidElement(a))throw new Error('Invalid dictionary id: "'.concat(r,'"'));a=a[o]}return a}(v,e)),o=i.entry,l=i.metadata;if(null!=o){var u,s;r&&(u=r,(null==l?void 0:l.variablesOptions)&&(s=l.variablesOptions)),"function"==typeof n?o=n(r):"function"==typeof o&&(o=o(r));var c=E(o,e);if(!j)return"string"==typeof c?a.renderContentToString(c,g,u,s):S({children:c,variables:u,variablesOptions:s,defaultLocale:g});if(P){var d=P[e];return"string"==typeof c?a.renderContentToString(d.t,[m,g],u,s):A({source:c,target:d.t,variables:u,variablesOptions:s,locales:[m,g]})}}else console.warn('Dictionary entry with id "'.concat(e,'" is null or undefined'))}),[v,P,j,g]);return e.jsx(s.Provider,{value:{translate:V,locale:m,defaultLocale:g,translations:P},children:P&&O?o:void 0})},exports.Num=h,exports.Plural=N,exports.T=function(n){var l=n.children,u=n.id,s=o(n,["children","id"]);if(!u)throw new Error("Client-side <T> with no provided 'id' prop. Children: ".concat(l));var p=s.variables,f=s.variablesOptions,b=c('<T id="'.concat(u,'"> used on the client-side outside of <GTProvider>')).translations,h=V();if(!l)return e.jsx(t.default.Fragment,{children:h(u,i({variables:p},f&&{variablesOptions:f}))},u);var g=v(),m=d(),y=r.useMemo((function(){return E(l)}),[l]);if(!(!!g&&!a.isSameLanguage(g,m)))return S({children:y,variables:p,variablesOptions:f,defaultLocale:m});var w=b[u];if(!w||!w.t)throw new Error('<T id="'.concat(u,'"> is used in a client component without a corresponding translation.'));return A({source:y,target:w.t,variables:p,variablesOptions:f,locales:[g,m]})},exports.Var=g,exports.useDefaultLocale=d,exports.useGT=V,exports.useLocale=v;
//# sourceMappingURL=index.cjs.js.map
