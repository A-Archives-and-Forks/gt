import a,{createContext as r,useContext as e,useState as n,useEffect as t}from"react";import{jsx as i}from"react/jsx-runtime";import{formatNum as o,formatCurrency as l,formatDateTime as v,determineLanguage as u}from"generaltranslation";import"generaltranslation/internal";var s=r(void 0);function d(a){void 0===a&&(a="useGTContext() must be used within a <GTProvider>!");var r=e(s);if(void 0===r)throw new Error(a);return r}var p=function(){return p=Object.assign||function(a){for(var r,e=1,n=arguments.length;e<n;e++)for(var t in r=arguments[e])Object.prototype.hasOwnProperty.call(r,t)&&(a[t]=r[t]);return a},p.apply(this,arguments)};function c(a){return a&&a.props&&a.props["data-generaltranslation"]?a.props["data-generaltranslation"]:null}"function"==typeof SuppressedError&&SuppressedError;var b={variable:"value",number:"n",datetime:"date",currency:"cost"};function f(a){var r,e=(null===(r=a["data-generaltranslation"])||void 0===r?void 0:r.variableType)||"variable";return{variableType:e,variableName:a.name||a["data-_gt-variable-name"]||b[e],variableValue:void 0!==a.value?a.value:void 0!==a["data-_gt-unformatted-value"]?a["data-_gt-unformatted-value"]:void 0!==a.children?a.children:void 0,variableOptions:a.options||a["data-_gt-variable-options"]||void 0}}function m(){return d("useLocale(): Unable to access user's locale outside of a <GTProvider>").locale}function g(){return d("useDefaultLocale(): Unable to access default locale outside of a <GTProvider>").defaultLocale}function y(a){var r=void 0===a?{name:"n"}:a,e=r.children,n=r.name,t=void 0===n?"n":n,l=r.value,v=r.options,u=void 0===v?{}:v,s=[m(),g()],d=void 0!==e?e:l;return"number"==typeof(d="string"==typeof d?parseFloat(d):d)&&(d=o({value:d,languages:s,options:u})),i("span",{"data-_gt-variable-name":t,"data-_gt-variable-type":"number","data-_gt-variable-options":JSON.stringify(u),children:d})}function h(a){var r=a.children,e=a.name,n=a.value;return i("span",{"data-_gt-variable-name":e,"data-_gt-variable-type":"variable",children:void 0!==r?r:n})}function O(a){var r=void 0===a?{name:"cost"}:a,e=r.children,n=r.name,t=void 0===n?"cost":n,o=r.value,v=r.currency,u=void 0===v?"USD":v,s=r.options,d=void 0===s?{}:s,c=[m(),g()],b=void 0!==e&&void 0===o?e:o;return"number"==typeof(b="string"==typeof b?parseFloat(b):b)&&(b=l({value:b,languages:c,currency:u,options:d})),i("span",{"data-_gt-variable-name":t,"data-_gt-variable-type":"currency","data-_gt-variable-options":p({style:"currency",currency:u},d),children:b})}function _(a){var r,e,n=void 0===a?{name:"date"}:a,t=n.children,o=n.name,l=void 0===o?"date":o,u=n.value,s=n.options,d=void 0===s?{}:s,p=[m(),g()],c=void 0!==t&&void 0===u?t:u;return"number"==typeof c||"string"==typeof c?e=new Date(c):c instanceof Date&&(e=c),void 0!==e&&(r=v({value:e,languages:p,options:d}).replace(/[\u200F\u202B\u202E]/g,"")),i("span",{"data-_gt-variable-name":l,"data-_gt-variable-type":"date","data-_gt-variable-options":d,children:r})}function E(a){if(a&&"object"==typeof a&&"string"==typeof a.key){var r=Object.keys(a);if(1===r.length)return!0;if(2===r.length){var e=a;return"string"==typeof e.variable&&["variable","number","date","currency"].includes(e.variable)}}return!1}y.gtTransformation="variable-number",h.gtTransformation="variable-variable",O.gtTransformation="variable-currency",_.gtTransformation="variable-datetime";var w="generaltranslation-locale",T="en";function V(a,r,e){var n="",t=null;return"number"==typeof a&&!t&&e&&(n=function(a,r,e){var n=new Intl.PluralRules(r).select(a),t=Math.abs(a);if(0===t&&e.zero)return"zero";if(1===t){if(e.singular)return"singular";if(e.one)return"one"}if("one"===n&&e.singular)return"singular";if(2===t){if(e.dual)return"dual";if(e.two)return"two"}return"two"===n&&e.dual?"dual":e[n]?n:"two"===n&&e.dual?"dual":"two"===n&&e.plural?"plural":"two"===n&&e.other?"other":"few"===n&&e.plural?"plural":"few"===n&&e.other?"other":"many"===n&&e.plural?"plural":"many"===n&&e.other?"other":"other"===n&&e.plural?"plural":""}(a,r,e)),n&&!t&&(t=e[n]),t}function j(a){var r=a.variableType,e=a.variableName,n=a.variableValue,t=a.variableOptions;return"number"===r?i(y,{name:e,value:n,options:t}):"datetime"===r?i(_,{name:e,value:n,options:t}):"currency"===r?i(O,{name:e,value:n,options:t}):i(h,{name:e,value:n})}function k(r){var e,n=r.sourceElement,t=r.targetElement,i=r.variables,o=void 0===i?{}:i,l=r.variablesOptions,v=void 0===l?{}:l,u=r.locales,s=void 0===u?[T]:u,d=n.props,c=d["data-generaltranslation"],b=null==c?void 0:c.transformation;if("plural"===b){var f="number"==typeof o.n?o.n:"number"==typeof n.props.n?n.props.n:n.props["data-_gt-n"],m=V(f,s,c.branches||{})||n.props.children,g=V(f,s,t.props["data-generaltranslation"].branches||{})||t.props.children;return a.createElement("span",p(p({},d),{"data-generaltranslation":void 0,children:N({source:m,target:g,variables:o,variablesOptions:v,locales:s})}))}if("branch"===b){var y=d.name,h=d.branch,O=d.children;h=o[y=y||n.props["data-_gt-name"]||"branch"]||h||n.props["data-_gt-branch-name"];m=(c.branches||{})[h]||O,g=(t.props["data-generaltranslation"].branches||{})[h]||t.props.children;return a.createElement("span",p(p({},d),{"data-generaltranslation":void 0,children:N({source:m,target:g,variables:o,variablesOptions:v,locales:s})}))}return(null==d?void 0:d.children)&&(null===(e=t.props)||void 0===e?void 0:e.children)?a.cloneElement(n,p(p({},d),{"data-generaltranslation":void 0,children:N({source:d.children,target:t.props.children,variables:o,variablesOptions:v,locales:s})})):n}function N(r){var e=r.source,n=r.target,t=r.variables,o=void 0===t?{}:t,l=r.variablesOptions,v=void 0===l?{}:l,u=r.locales,s=void 0===u?[T]:u;if(null==n&&e)return e;if("string"==typeof n)return n;if(Array.isArray(e)&&Array.isArray(n)){var d=e.filter((function(r){if(a.isValidElement(r)){var e=c(r);if(f(r.props),"variable"!==(null==e?void 0:e.transformation))return!0;var n=f(r.props),t=n.variableName,i=n.variableValue,l=n.variableOptions;void 0===o[t]&&(o[t]=i),v[t]=p(p({},v[t]),l)}}));return n.map((function(r,e){if("string"==typeof r)return i(a.Fragment,{children:r},"string_".concat(e));if(E(r))return i(a.Fragment,{children:j({variableType:r.variable||"variable",variableName:r.key,variableValue:o[r.key],variableOptions:v[r.key]})},"var_".concat(e));var n,t=(n=r,d.find((function(a){var r,e,t=c(a);return void 0!==(null==t?void 0:t.id)&&t.id===(null===(e=null===(r=null==n?void 0:n.props)||void 0===r?void 0:r["data-generaltranslation"])||void 0===e?void 0:e.id)})));return t?i(a.Fragment,{children:k({sourceElement:t,targetElement:r,variables:o,variablesOptions:v,locales:s})},"element_".concat(e)):void 0}))}if(n&&"object"==typeof n&&!Array.isArray(n)){var b=E(n)?"variable":"element";if(a.isValidElement(e)){if("element"===b)return k({sourceElement:e,targetElement:n,variables:o,variablesOptions:v,locales:s});var m=c(e);if("variable"===(null==m?void 0:m.transformation)){var g=f(e.props),y=g.variableName,h=g.variableValue,O=g.variableOptions;void 0===o[y]&&(o[y]=h),v[y]=p(p({},v[y]),O)}}if("variable"===b){var _=n;return j({variableType:_.variable||"variable",variableName:_.key,variableValue:o[_.key],variableOptions:v[_.key]})}}return e}function A(r){var e=r.children,n=r.variables,t=void 0===n?{}:n,i=r.variablesOptions,o=void 0===i?{}:i,l=r.defaultLocale,v=void 0===l?T:l,u=function(r){if(a.isValidElement(r)){var e=c(r);if("variable"===(null==e?void 0:e.transformation)){var n=f(r.props),i=n.variableName,l=n.variableType,u=n.variableValue,d=n.variableOptions;return j({variableName:i,variableType:l,variableValue:u=void 0!==t[i]?t[i]:u,variableOptions:p(p({},o[i]),d)})}if("plural"===(null==e?void 0:e.transformation)){var b="number"==typeof t.n?t.n:"number"==typeof r.props.n?r.props.n:r.props["data-_gt-n"],m=e.branches||{};return a.createElement("span",p(p({},r.props),{"data-generaltranslation":void 0,children:s(V(b,[v],m)||r.props.children)}))}if("branch"===(null==e?void 0:e.transformation)){var g=r.props;g.children;var y=g.name,h=g.branch;m=function(a,r){var e={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(e[n]=a[n]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(n=Object.getOwnPropertySymbols(a);t<n.length;t++)r.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(a,n[t])&&(e[n[t]]=a[n[t]])}return e}(g,["children","name","branch"]);return y=y||r.props["data-_gt-name"]||"branch",h=t[y]||h||r.props["data-_gt-branch-name"],m=e.branches||{},a.createElement("span",p(p({},r.props),{"data-generaltranslation":void 0,children:s(m[h])}))}if(r.props.children)return a.cloneElement(r,p(p({},r.props),{"data-generaltranslation":void 0,children:s(r.props.children)}))}return r},s=function(r){return Array.isArray(r)?a.Children.map(r,u):u(r)};return s(e)}function P(a,r,e){void 0===a&&(a=T),void 0===r&&(r=w);var i=n(""),o=i[0],l=i[1];return t((function(){var n,t=(r?function(a){void 0===a&&(a=w);for(var r=0,e=document.cookie.split("; ");r<e.length;r++){var n=e[r].split("="),t=n[0],i=n[1];if(t===a)return decodeURIComponent(i)}return null}(r):void 0)||(e?u(navigator.languages,e):void 0)||(null===(n=navigator.languages)||void 0===n?void 0:n[0])||navigator.language||(null===navigator||void 0===navigator?void 0:navigator.userLanguage)||a;l(t)}),[a,e]),o}export{s as _GTContext,A as _renderDefaultChildren,N as _renderTranslatedChildren,P as useBrowserLocale};
//# sourceMappingURL=client.esm.min.mjs.map
